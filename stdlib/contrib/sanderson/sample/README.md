# Sample Package

The Sample package provides functions for generating and incrementing sample data in InfluxDB.
Import the `contrib/sanderson/sample` package:

```js
import "contrib/sanderson/sample"
```

## Functions

- [`sample.generate()`](#sample-generate)

### sample.generate
The `sample.generate()` function takes [annotated CSV](https://v2.docs.influxdata.com/v2.0/reference/syntax/annotated-csv/)
seed data, generates, and then increments sample data at regular intervals.
The function is designed to be used with [InfluxDB tasks](https://v2.docs.influxdata.com/v2.0/process-data/get-started/).

```js
import "contrib/sanderson/sample"

sample.generate(
  bucket: "example-bucket",
  seed: seedCSV,
  incrementFn: (r) => ({ r with _value: r._value + 1.0 }))
  every: 1m,
  predicate: (r) => true
)
```

#### Parameters

##### bucket
The bucket to query.

_**Data type:** String_

##### seed
Annotated CSV to use as seed data.

_**Data type:** String_

##### incrementFn
Map-like function that increments values in the data set.

_**Data type:** Function_

##### every
The interval that new data is generated at.

> When used with an InfluxDB task, set to `task.every`.
> When used in the InfluxDB Data Explorer, use the refresh interval.

_**Data type:** Duration_

##### predicate
Predicate function used to query the previously generated data.
Default is `(r) => true`.

> Only customize the predicate if generated data is written to a bucket with
> data not generated by the function.

_**Data type:** Function_


#### Example – Generate sample data

Here's an example definition for the `discord.send()` function.

```js
import "contrib/sanderson/sample"
import "math"

options task = {
  name: "Generate Sample Data",
  every: 15s
}

bucket = "example-bucket"

seed = "#datatype,string,long,string,string,string,double
#group,false,false,true,true,true,false
#default,,,,,,
,result,table,_measurement,sensor_id,_field,_value
,,0,airSensors,TLM0100,temperature,71.2
,,1,airSensors,TLM0100,humidity,35.1
,,2,airSensors,TLM0100,co,0.5
,,3,airSensors,TLM0101,temperature,71.8
,,4,airSensors,TLM0101,humidity,34.9
,,5,airSensors,TLM0101,co,0.5
,,6,airSensors,TLM0102,temperature,72.0
,,7,airSensors,TLM0102,humidity,34.9
,,8,airSensors,TLM0102,co,0.5
,,9,airSensors,TLM0103,temperature,71.3
,,10,airSensors,TLM0103,humidity,35.2
,,11,airSensors,TLM0103,co,0.4
"

incrementFn = (r) => ({
  r with _value:
    if r._field == "co" and r.sensor_id =~ /101/ then math.mMax(x: r._value + math.randFloat(min: -0.05, max: 0.25), y: 0.0)
    else if r._field == "co" then math.mMax(x: r._value + math.randFloat(min: -0.2, max: 0.2), y: 0.0)
    else r._value + math.randFloat(min: -0.25, max: 0.25)
})

sample.generate(
  bucket: bucket,
  seed: seed,
  incrementFn: incrementFn,
  every: task.every
)
|> to(bucket: bucket, org: "example-org")
```

## Contact
**Author:** Scott Anderson  
**Email:** scott@influxdata.com  
**Github:** [@sanderson](https://github.com/sanderson)  
**Influx Slack:** [@Scott Anderson](https://influxdata.com/slack)  
